<!DOCTYPE html>
<html>
<head>
    <title>JSON Editor Example</title>
    
    <!-- placeholders for the theme switcher -->
    <link rel='stylesheet' id='theme_stylesheet'>
    <link rel='stylesheet' id='icon_stylesheet'>
    
    <style>[class*="foundicon-"] {font-family: GeneralFoundicons;font-style: normal;}</style>
    <script src='dist/jsoneditor.js'></script>
</head>
<body>
<div class='container'>
    <div class='row'>
        <div class='span4 col-md-4 columns four large-4'>
            CSS Framework: 
            <select id='theme_switcher'>
                <option value='html'>None</option>
                <option value='jqueryui'>jQuery UI</option>
                <option value='bootstrap2'>Bootstrap 2</option>
                <option value='bootstrap3'>Bootstrap 3</option>
                <option value='foundation3'>Foundation 3</option>
                <option value='foundation4'>Foundation 4</option>
                <option value='foundation5'>Foundation 5</option>
            </select>
        </div>
        <div class='span4 col-md-4 columns four large-4'>
            Icon Library:
            <select id='icon_switcher'>
                <option value=''>None</option>
                <option value='jqueryui'>jQuery UI</option>
                <option value='bootstrap2'>Bootstrap 2 Glyphicons</option>
                <option value='bootstrap3'>Bootstrap 3 Glyphicons</option>
                <option value='foundation2'>Foundicons 2</option>
                <option value='foundation3'>Foundicons 3</option>
                <option value='fontawesome3'>FontAwesome 3</option>
                <option value='fontawesome4'>FontAwesome 4</option>
            </select>
        </div>
        <div class='span4 col-md-4 columns four large-4'>
        </div>
    </div>
    <div class='row'>
        <div class='span8 col-md-8 columns eight large-8'>
            <h2>Editor</h2>
            <p>Below is the editor generated from the JSON Schema.</p>

            <div id='editor'></div>
        </div>
        <div class='span4 col-md-4 columns four large-4'>
            <h2>JSON Output</h2>
            <p>You can also make changes to the JSON here and set the value in the editor by clicking <button class='btn btn-primary' id='setvalue'>Update Form</button></p>

            <textarea id='output' style='width: 100%; height: 300px; font-family: monospace;'></textarea>
            
            <h2>Validation</h2>
            
            <p>This will update whenever the form changes to show validation errors if there are any.</p>
            
            <textarea id='validate' style='width: 100%; height: 200px; font-family: monospace;' readonly disabled></textarea>
    </div>
    <div class='row'>
        <div class='span12 col-md-12 columns twelve large-12'>
            <h2>Schema</h2>
            <p>You can change the schema and see how the generated form looks.  After you make changes, click <button class='btn btn-primary' id='setschema'>Update Schema</button></p>

            <textarea id='schema' style='width: 100%; height: 450px; font-family: monospace;'></textarea>
        </div>
    </div>
    <div class='row'>
        <div class='span12 col-md-12 columns twelve large-12'>
            <h2>Code</h2>
            <pre><code>// Initialize the editor
var editor = new JSONEditor(document.getElementById("editor_holder"),{
   schema: {...},
   theme: 'bootstrap2'
});

// Set the value
editor.setValue({...});

// Get the value
var data = editor.getValue();

// Validate
var errors = editor.validate();
if(errors.length) {
  // Not valid
}

// Listen for changes
editor.on("change",  function() {
  // Do something...
});
</code></pre>
        </div>
    </div>
</div>
<script>
(function() {
    var schema = {
        title: "Person",
        type: "object",
        properties: {
            name: {
                type: "string",
                description: "First and Last name",
                pattern: '^[A-Z][a-z]+ [A-Z][a-z]+$',
                default: "John Smith"
            },
            age: {
                type: ["integer","string"],
                default: 21,
                format: "range",
                minimum: 18,
                maximum: 99
            },
            favorite_color: {
                type: "string",
                format: "color",
                title: "favorite color"
            },
            gender: {
                type: "string",
                enum: ["male", "female"]
            },
            location: {
                type: "object",
                properties: {
                    city: {
                        type: "string"
                    },
                    state: {
                        type: "string"
                    },
                    citystate: {
                        type: "string",
                        description: "This is generated automatically from the previous two fields",
                        template: "{{city}}, {{state}}",
                        watch: {
                            city: 'location.city',
                            state: 'location.state'
                        }
                    }
                },
                required: ["city","state"]
            },
            status: {
              type: "object",
              enum: [
                {
                    single: true,
                    kids: 'none'
                },
                {
                    married: true,
                    kids: 1
                },
                {
                    married: true,
                    kids: [{gender: 'boy'},{gender: 'girl'}]
                }
              ]  
            },
            pets: {
                type: "array",
                format: "tabs",
                title: "Pets",
                uniqueItems: true,
                items: {
                    type: "object",
                    properties: {
                        type: {
                            type: "string",
                            enum: ["cat","dog","bird","reptile","other"],
                            default: "dog"
                        },
                        name: {
                            type: "string"
                        }
                    },
                    required: ["type","name"]
                }
            }
        },
        required: ["name","age"]
    };

    // Divs/textareas on the page
    var $schema = document.getElementById('schema');
    var $output = document.getElementById('output');
    var $editor = document.getElementById('editor');
    var $validate = document.getElementById('validate');
    
    // Buttons
    var $set_schema_button = document.getElementById('setschema');
    var $set_value_button = document.getElementById('setvalue');
    
    var jsoneditor;
    
    var reload = function() {
        if(jsoneditor) jsoneditor.destroy();
        jsoneditor = new JSONEditor($editor,{
           schema: schema,
           object_layout: 'grid' 
        });
    
        // When the value of the editor changes, update the JSON output and validation message
        jsoneditor.on('change',function() {
            var json = jsoneditor.getValue();
            
            $output.value = JSON.stringify(json,null,2);
            
            var validation_errors = jsoneditor.validate();
            // Show validation errors if there are any
            if(validation_errors.length) {
                $validate.value = JSON.stringify(validation_errors,null,2);
            }
            else {
                $validate.value = 'valid';
            }
        });
    };
    reload();
    
    // Start the schema and output textareas with initial values
    $schema.value = JSON.stringify(schema,null,2);
    $output.value = '';
    
    // When the 'update form' button is clicked, set the editor's value
    $set_value_button.addEventListener('click',function() {
       jsoneditor.setValue(JSON.parse($output.value));
    });
    
    // Update the schema when the button is clicked
    $set_schema_button.addEventListener('click',function() {
       try {
           schema = JSON.parse($schema.value);
       }
       catch(e) {
           alert('Invalid Schema: '+e.message);
           return;
       }
       
       reload();
    });
    
    // Set the theme by loading the right stylesheets
    var setTheme = function(theme) {
        theme = theme || '';
        
        var mapping = {
          html: '',  
          bootstrap2: '//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css',  
          bootstrap3: '//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css',  
          foundation3: '//cdnjs.cloudflare.com/ajax/libs/foundation/3.2.5/stylesheets/foundation.css',  
          foundation4: '//cdn.jsdelivr.net/foundation/4.3.2/css/foundation.min.css',  
          foundation5: '//cdn.jsdelivr.net/foundation/5.0.2/css/foundation.min.css',  
          jqueryui: '//code.jquery.com/ui/1.10.3/themes/south-street/jquery-ui.css',  
        };
        
        if(typeof mapping[theme] === 'undefined') {
            theme = 'bootstrap3';
            document.getElementById('theme_switcher').value = theme;
        }
        
        JSONEditor.defaults.theme = theme;
        
        document.getElementById('theme_stylesheet').href = mapping[theme];
        document.getElementById('theme_switcher').value = JSONEditor.defaults.theme;
        
        reload();
    };
    
    // Set the icontheme
    // Set the theme by loading the right stylesheets
    var setIconlib = function(iconlib) {
        iconlib = iconlib || '';
        var mapping = { 
          foundation2: '//cdnjs.cloudflare.com/ajax/libs/foundicons/2.0/stylesheets/general_foundicons.css',  
          foundation3: '//cdnjs.cloudflare.com/ajax/libs/foundicons/3.0.0/foundation-icons.css',  
          fontawesome3: '//cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.css',  
          fontawesome4: '//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.0.3/css/font-awesome.css',  
        };
        
        JSONEditor.defaults.iconlib = iconlib;
        
        document.getElementById('icon_stylesheet').href = mapping[iconlib] || '';
        document.getElementById('icon_switcher').value = JSONEditor.defaults.iconlib;
        
        
        reload();
    };
    
    document.getElementById('theme_switcher').addEventListener('change',function() {
       setTheme(this.value,true); 
    });
    document.getElementById('icon_switcher').addEventListener('change',function() {
       setIconlib(this.value,true); 
    });
    
    setTheme((window.location.href.match('[?&]theme=([^&]+)')||[])[1] || 'bootstrap2');
    setIconlib((window.location.href.match('[?&]iconlib=([^&]+)')||[])[1] || 'fontawesome4');
})();
</script>
</body>
</html>
